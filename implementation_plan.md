# План внедрения расширений прототипа SkyLuxse SPA

## 1. Расширение ролевой модели (`index.html:488`, `index.html:595`, `PRD.md:74`)
- **Цель**: добавить роли Sale Manager и Client с отдельными сценариями и ограничениями доступа.
- **Основные задачи**:
  - Пересобрать `ROLES_CONFIG`, разделив навигацию и стартовые страницы для каждой роли.
  - Настроить вывод компонентов и действий в зависимости от `currentRole`, скрывая чужой функционал.
  - Обновить переключатель ролей и страницу логина (подготовить к дальнейшему MFA/OTP).
- **Артефакты**: обновлённый модуль конфигурации ролей, карта доступов по компонентам.

## 2. Расширение дашборда руководства (`index.html:238`, `PRD.md:216`)
- **Цель**: показать KPI для задач, эффективности команд и водителей на живых данных.
- **Основные задачи**:
  - Консолидировать метрики по парку, задачам, клиентам и водителям.
  - Добавить карточки KPI (например, SLA задач, выполненные задачи, NPS клиентов).
  - Подготовить API-моки/адаптер для последующей интеграции с реальными источниками.
- **Артефакты**: новая сетка метрик, конфигурация источников данных, схема обновления.

## 3. Интерактивная аналитика (`index.html:259`, `PRD.md:224`)
- **Цель**: заменить статические графики на интерактивные отчёты и прогнозы.
- **Основные задачи**:
  - Добавить фильтры дат и сегментов (классы авто, тип заказов).
  - Реализовать дополнительные диаграммы (финансы, эффективность водителей) и мок-прогнозы.
  - Создать слой агрегации данных с временными сериями.
- **Артефакты**: расширенный модуль визуализации, провайдер данных для графиков.

## 4. Канбан с бизнес-правилами (`index.html:300`, `PRD.md:86`)
- **Цель**: усилить управление заказами фильтрами и авто-логикой статусов.
- **Основные задачи**:
  - Ввести фильтрацию по приоритету, типу, водителю, клиенту.
  - Настроить цветовую кодировку карточек по типам/приоритетам.
  - Добавить перетаскивание с проверкой бизнес-правил и автоматическими действиями (назначения, уведомления).
- **Артефакты**: модуль фильтрации, конфиг правил переходов, расширенные карточки заказа.

## 5. Календарь автопарка (`index.html:306`, `PRD.md:104`)
- **Цель**: сделать календарь многонедельным с типами событий и планированием ТО.
- **Основные задачи**:
  - Поддержать диапазоны дат (переключение недель/месяцев).
  - Цветовая маркировка и легенда по типам бронирований (Rental, Maintenance, Incident, Repair).
  - Интерактивные всплывающие детали, создание событий ТО, напоминания.
- **Артефакты**: расширенный календарный компонент, справочник типов событий, UI планировщика ТО.

## 6. Таблицы автопарка и клиентов (`index.html:417`, `PRD.md:111`)
- **Цель**: обогатить таблицы документами, инспекциями и статусами обслуживания.
- **Основные задачи**:
  - Добавить колонки и модальные окна для документов, страховок, mulkiya, истории ТО.
  - Настроить напоминания по истечению документов (цветовые индикаторы, фильтры).
  - Создать центральный стор/моки с историей инспекций и обслуживаний.
- **Артефакты**: переработанные таблицы, модальные карточки, напоминания.

## 7. Система задач с типами (`index.html:411`, `PRD.md:126`)
- **Цель**: внедрить типы задач, кастомные поля и валидации.
- **Основные задачи**:
  - Определить словарь типов задач (подготовка, доставка, инспекция и т.д.) с конфигом полей.
  - Расширить формы создания/редактирования с валидацией по типам.
  - Добавить дашборд задач с фильтрами и SLA.
- **Артефакты**: конфигурация типов задач, валидатор форм, обновлённый UX доски задач.

## 8. Мобильный сценарий водителя (`index.html:441`, `PRD.md:145`)
- **Цель**: подготовить мобильную версию с GPS, маршрутами и PWA.
- **Основные задачи**:
  - Добавить координаты точек назначения и кнопки навигации (Deep Link в карты).
  - Подключить PWA-манифест, сервис-воркер, offline storage для задач и чек-листов.
  - Реализовать мок GPS-трекинга и отображение статуса соединения.
- **Артефакты**: PWA-конфигурация, мобильные карты задач, офлайн-стор для данных водителя.

## 9. Расширение карточки задачи водителя (`index.html:950`, `PRD.md:165`)
- **Цель**: позволить вводить показания, наличные и контролировать штрафы.
- **Основные задачи**:
  - Добавить поля для пробега, уровня топлива, принятых наличных, доп. услуг.
  - Проверка штрафов/платных дорог по кнопке с отображением результатов.
  - Фотофиксация подтверждений (чеки, платежи) с локальной валидацией и загрузкой.
- **Артефакты**: новые секции формы, модуль проверки штрафов, медиа-хранилище (моки).

## 10. Клиентская панель (`index.html:825`, `PRD.md:289`)
- **Цель**: расширить карточку клиента документами, финансами и управлением уведомлениями.
- **Основные задачи**:
  - Добавить вкладки: документы, финансовая история, настройки уведомлений.
  - Связать с данными Zoho/Kommo (пока через моки) и предоставить self-service действия (скачивание документов, оплата).
  - Настроить отображение задолженностей и доступных операций.
- **Артефакты**: обновлённая карточка клиента, адаптер финансовых данных, UI уведомлений.

## 11. Клиентский портал (FR-028–033)
- **Цель**: выделить отдельный интерфейс с личным кабинетом, FAQ, базой знаний и историей оплат.
- **Основные задачи**:
  - Создать отдельный роут и shell для клиента с навигацией по разделам (Dashboard, Rentals, Payments, Documents, FAQ).
  - Реализовать модули: история аренд, документы, база знаний, настройки уведомлений.
  - Подключить общий слой данных с основным SPA (shared store/service).
- **Артефакты**: маршруты портала клиента, компоненты разделов, дизайн-гайд по порталу.

## 12. Центр уведомлений (`PRD.md:319`)
- **Цель**: внедрить единую систему уведомлений по email/SMS/push.
- **Основные задачи**:
  - Создать компонент Notification Center с фильтрацией по ролям, приоритетам, каналам.
  - Настроить мок-адаптеры каналов (email, SMS, push), подготовить структуру настроек.
  - Интегрировать уведомления в ключевые сценарии (изменение статусов заказа, задачи, документы).
- **Артефакты**: Notification Center UI, настройки каналов, карта триггеров уведомлений.

## Депенденси и общие шаги
- **Архитектура данных**: обновить мок-стор (или подготовить JSON-сервисы) для новых полей и сущностей (задачи, документы, события календаря).
- **Навигация/роутинг**: провести ревизию маршрутов SPA, чтобы поддержать новые страницы (клиентский портал, отчёты, FAQ).
- **Общие UI-компоненты**: вынести повторяющиеся элементы (карточки, модальные окна, табы) для переиспользования.
- **Тестирование**: подготовить чек-лист UX и smoke-тестов для менеджера, водителя, клиента и руководства.
